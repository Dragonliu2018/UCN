# 第8讲  数据安全——保护数据的保密性、完整性、不可否认性、可认证性和存在性

## **保护数据的保密性：\(非\)对称密码算法**

### **0x01** 对称密码算法的特点

在对称密码算法中，加密过程与解密过程使用相同或容易相互推导得出的密钥，即加密和解密两方的密钥是“对称”的。

### 0x02 对称密码算法的分类

* 根据密码算法对明文信息的加密方式，对称密码体制通常包括分组密码、序列密码、消息认证码 、哈希函数和认证加密算法。
* **分组密码**：是将明文数据分成多个等长的数据块（这样的数据块就是分组），对每个块以同样的密钥和同样的处理过程进行加密或解密。加解密过程一般采用混淆和扩散功能部件的多次迭代。 分组密码不用产生很长的密钥，适应能力强，多用于大数据量的加密场景。例如：DES、3-DES（triple DES）、IDEA、AES
* **序列密码**：序列密码（Stream Cipher，也叫流密码），是将明文数据的每一个字符或位逐个与密钥的对应分量进行加密或解密计算。序列密码需要快速产生一个足够长的密钥，因为，有多长的明文就要有多长的密钥。为此，序列密码的一个主要任务是 快速产生一个足够长的“密钥流”。序列密码的强度依靠密钥序列的随机性和不可预测性。代表性的序列密码算法是RC系列算法，包括RC2 、RC4、RC5和RC6。

### 0x03 对称密码算法的功能

1. 保护信息机密
2. 认证发送方之身份
3. 确保信息完整性

### 0x04 对称密码算法的缺陷

1. 密钥管理的困难性
2. 陌生人之间的保密通信
3. 无法达到不可否认服务

### 0x05 公钥密码体制的内容

1. 接收方B产生一对公钥（PKB）和私钥（SKB）
2. B将公钥PKB放在一个公开的寄存器或文件中 ，通常放入管理密钥的密钥分发中心。私钥SKB则被用户保存。 
3. A如果要向B发送消息M，则首先必须得到并使用B的公钥加密M，表示为C=EPKB \(M\)，其中C是密文，E是加密算法。
4. B收到A的密文后，用自己的私钥解密得到明文信息，表示为M＝DSKB \(C\)，其中D是解密算法

### 0x06 公钥密码体制的功能

1. 保护信息的机密性。发送方用接收方的公钥将明文加密成密文，此后只有拥有私钥的接收方才能解密
2. 简化密钥分配及管理。保密通信系统中的每一人只需要一对公钥和私钥。 ❖3）密钥交换。发送方和接收方可以利用公钥密码体制传送会话密钥。
3. 实现不可否认。若发送方用自己的私钥将明文加密成密文（签名），则任何人均能用公开密钥将密文解密（验证签名）进行鉴别。这里的密文（签名）就如同发送方亲手签名一样，日后有争执时，第三方可以很容易作出正确的判断。公钥密码算法的这种应用称为数字签名，后续将详细介绍。这种基于数字签名的方法也可提供认证功能。

### 0x07 公钥密码算法（非对称密码算法）

1. RSA
2. ECC算法

## **保护数据的完整性**

### **0x01** 哈希函数的概念

哈希（Hash））函数又称为散列函数、消息摘要 （Message Digest）函数、杂凑函数。 哈希函数可以把满足要求的任意长度的输入转换成固定长度的输出。 它是一种单向密码体制，即从明文到密文的不可逆映射，只有加密过程，没有解密过程。 与对称密码算法和公钥密码算法不同，哈希函数没有密钥。

### 0x02 哈希函数的特性

1. 易压缩。对任意大小的信息产生很小长度的哈希值。例如产生160位的哈希值，即20个字节。而且对同一个源数据反复执行哈希函数得到的哈希值保持一致
2. 不可预见。产生的哈希值的长度和内容与原始信息的大小和内容没有任何联系，但是源数据的一个微小变化都会影响哈希值的内容。
3. 不可逆。哈希函数是单向的，从源数据很容易计算其哈希值，但是无法通过生成的哈希值恢复源数据。
4. 抗碰撞。寻找两个不同输入得到相同的哈希值在计算上是不可行的。如果能够找到两个不一样的消息，但是计算出的哈希值一样，则称之为碰撞（Collision）
5. 高灵敏。对于输入数据的某几位的变化会引起所生成的哈希值几乎所有位的变化。

### 0x03 哈希函数的应用

1. 校验数据完整性
2. 数字签名
3. 消息认证
4. 保护用户口令
5. 区块链

### 0x04 常用的哈希函数

常用的哈希函数有两类：MD5（Message Digest Algorithm 5，消息摘要算法第5版）和 SHA（Secure Hash Algorithm，安全哈希算法）

## **保护数据的不可否认性和可认证性**

### **0x01** 数字签名的概念

* 在传统的以书面文件为基础的日常事务处理中，通常采用书面签名的形式，如手写签名、印章、手印等，来确保当事人的身份真实和不可否认。这样的书面签名具有一定的法律意义。在以计算机为基础的数字信息处理过程中， 就应当采用电子形式的签名，即数字签名（Digital Signatures）。
* 数字签名是一种以电子形式存在于数据信息之中的，或作为附件，或逻辑上与之有关联的数据，可用于接收者验证数据的完整性和数据发送者的身份，也可用于第三方验证签名和所签名数据的真实性。

### **0x02** 数字签名的特性

1. 不可否认。签署人不能否认自己的签名
2. 不可伪造。任何人不能伪造数字签名
3. 可认证。签名接收者可以验证签名的真伪，也可以通过第三方仲裁来解决争议和纠纷。签名接收者还可通过验证签名，确保信息未被篡改。

### **0x03** 数字签名的实现

1. 基于公钥密码体制的数字签名
2. 基于公钥密码体制和哈希函数的数字签名
3. 基于公钥密码算法和哈希函数进行数字签名和加密

### **0x04** 数字签名算法

1. 目前主要采用基于公钥密码体制的数字签名，包括普通数字签名和特殊数字签名
2. 普通数字签名算法有RSA、ElGamal、椭圆曲线数字签名算法等
3. 特殊数字签名有盲签名、代理签名、群签名等。

### 0x05 消息认证

1. 消息认证的概念
2. 消息认证码

## **保护数据的存在性**

### **0x01** 信息隐藏的概念

信息隐藏\(Information Hiding\)，是指将机密信息秘密隐藏于另一公开的信息（通常为称为载体 ）中，然后将其通过公开通道来传递。

### 0x02 信息隐藏的原理

1. 将信息嵌入到图像点中最不重要的像素位\(Least Significant Bits，LSB\)算法的原理，该算法简称LSB算法。 也就是利用人视觉上的不可见性缺陷，将信息嵌入到图像最不重要的像素位上，如最低几位。

## **数据文件保护实例**

### **0x01** Windows系统常用文档安全问题分析

1. 非授权访问。即未经文档的所有人同意，查看、修改、拷贝文档； 
2. 篡改。文档的内容被非授权修改； 
3. 伪造或否认。伪造或否认文档的内容； 
4. 意外损坏，如删除。

### 0x02 Windows系统常用文档安全防护

1. 设置口令认证、修改权限保护
2. 文档加密、隐藏保护
3. 文档的备份/恢复与强力擦除
4. 文档完整性检测和数字签名
5. PGP综合安全防护

